($=>{$(function(){for(var wb_ads_elmt=document.getElementsByClassName("wbcom-faq-accordion"),wb_ads_elmt_len=wb_ads_elmt.length,k=0;k<wb_ads_elmt_len;k++)wb_ads_elmt[k].onclick=function(){this.classList.toggle("active");var panel=this.nextElementSibling;panel.style.maxHeight?panel.style.maxHeight=null:panel.style.maxHeight=panel.scrollHeight+"px"};$(document).on("click",".button-secondary-reset",function(e){e.preventDefault();var $button=$(this),originalText=$button.text();if("undefined"==typeof wc_email_customizer_email_ajx)console.warn("Reset button clicked outside customizer context"),alert("This functionality is only available in the Email Customizer. Please go to WooCommerce > Email Customizer to use this feature.");else if(wc_email_customizer_email_ajx.nonce)if(wc_email_customizer_email_ajx.ajaxurl){$button.prop("disabled",!0).text("Resetting...");var selectedTemplate="default";try{"undefined"!=typeof wp&&wp.customize&&wp.customize("woocommerce_email_template")&&(selectedTemplate=wp.customize("woocommerce_email_template")())}catch(error){console.warn("Could not get current template, using default:",error)}console.log("Resetting template to:",selectedTemplate),console.log("Available nonce:",wc_email_customizer_email_ajx.nonce),console.log("AJAX URL:",wc_email_customizer_email_ajx.ajaxurl),$.ajax({type:"post",url:wc_email_customizer_email_ajx.ajaxurl,data:{action:"wb_email_customizer_load_template_presets",template:selectedTemplate,nonce:wc_email_customizer_email_ajx.nonce,_wpnonce:wc_email_customizer_email_ajx.nonce,_ajax_nonce:wc_email_customizer_email_ajx.nonce},timeout:3e4,beforeSend:function(){console.log("Sending AJAX request with data:",{action:"wb_email_customizer_load_template_presets",template:selectedTemplate,nonce:wc_email_customizer_email_ajx.nonce?"present":"missing"})},success:function(res){console.log("Reset response:",res),!0===res.success?($button.text("Reset Complete!").removeClass("button-secondary").addClass("button-primary"),setTimeout(function(){window.location.reload()},1e3)):(console.error("Reset failed:",res),$button.text("Reset Failed").addClass("button-error"),res=res.data||"Failed to reset template. Please try again.","undefined"!=typeof wp&&wp.customize&&wp.customize.notifications?wp.customize.notifications.add("reset_error",new wp.customize.Notification("reset_error",{message:res,type:"error",dismissible:!0})):alert(res),setTimeout(function(){$button.prop("disabled",!1).text(originalText).removeClass("button-error")},3e3))},error:function(xhr,status,error){console.error("AJAX error during reset:",{status:status,error:error,response:xhr.responseText,responseJSON:xhr.responseJSON}),$button.text("Network Error").addClass("button-error");error="Network error occurred. Please check your connection and try again.";"timeout"===status?error="Request timed out. Please try again.":xhr.responseText&&-1!==xhr.responseText.indexOf("Security check failed")&&(error="Security check failed. Please refresh the page and try again."),"undefined"!=typeof wp&&wp.customize&&wp.customize.notifications?wp.customize.notifications.add("reset_network_error",new wp.customize.Notification("reset_network_error",{message:error,type:"error",dismissible:!0})):alert(error),setTimeout(function(){$button.prop("disabled",!1).text(originalText).removeClass("button-error")},3e3)}})}else console.error("AJAX URL not available"),alert("AJAX URL missing. Please refresh the page and try again.");else console.error("Nonce not available"),alert("Security token missing. Please refresh the page and try again.")}),window.WBEmailCustomizer={showNotification:function(message,type){var notificationId;type=type||"info","undefined"!=typeof wp&&wp.customize&&wp.customize.notifications?(notificationId="wb_notification_"+Date.now(),wp.customize.notifications.add(notificationId,new wp.customize.Notification(notificationId,{message:message,type:type,dismissible:!0})),"info"!==type&&"success"!==type||setTimeout(function(){wp.customize.notifications.remove(notificationId)},5e3)):alert(message)},debug:function(message,data){window.console&&console.log&&console.log("[WB Email Customizer] "+message,data||"")},isEmailCustomizer:function(){return-1!==window.location.href.indexOf("email-customizer-for-woocommerce")||"undefined"!=typeof wp&&wp.customize&&wp.customize.panel&&wp.customize.panel("wc_email_customizer_panel")}},WBEmailCustomizer.debug("Admin script loaded",{isCustomizer:WBEmailCustomizer.isEmailCustomizer(),ajaxUrl:"undefined"!=typeof wc_email_customizer_email_ajx?wc_email_customizer_email_ajx.ajaxurl:"not available",nonce:"undefined"!=typeof wc_email_customizer_email_ajx&&wc_email_customizer_email_ajx.nonce?"present":"missing",nonceValue:"undefined"!=typeof wc_email_customizer_email_ajx?wc_email_customizer_email_ajx.nonce:"not available",context:-1!==window.location.href.indexOf("customize.php")?"customizer":"admin"}),$(document).ajaxError(function(event,xhr,settings,thrownError){settings.data&&-1!==settings.data.indexOf("wb_email_customizer")&&WBEmailCustomizer.debug("AJAX Error",{url:settings.url,data:settings.data,error:thrownError,status:xhr.status,responseText:xhr.responseText})})})})(jQuery);